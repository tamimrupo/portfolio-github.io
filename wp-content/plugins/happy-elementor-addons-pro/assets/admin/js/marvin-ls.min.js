"use strict";window.XdUtils=window.XdUtils||{extend:function(e,n){var t,i=n||{};for(t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}},window.xdLocalStorage=window.xdLocalStorage||function(){function n(e){var n;try{n=JSON.parse(e.data)}catch(e){}n&&n.namespace===d&&("iframe-ready"===n.id?(f=!0,c.initCallback()):l[(e=n).id]&&(l[e.id](e),delete l[e.id]))}function i(e,n,t,i){l[++s]=i;i={namespace:d,id:s,action:e,key:n,value:t};r.contentWindow.postMessage(JSON.stringify(i),"*")}function t(e){c=XdUtils.extend(e,c);e=document.createElement("div");window.addEventListener?window.addEventListener("message",n,!1):window.attachEvent("onmessage",n),e.innerHTML='<iframe id="'+c.iframeId+'" src='+c.iframeUrl+' style="display: none;"></iframe>',document.body.appendChild(e),r=document.getElementById(c.iframeId)}function a(){return u?f||(console.log("You must wait for iframe ready message before using the api."),0):(console.log("You must call xdLocalStorage.init() before using it."),0)}function o(){return"complete"===document.readyState}var r,d="cross-domain-local-message",c={iframeId:"cross-domain-iframe",iframeUrl:void 0,initCallback:function(){}},s=-1,l={},u=!1,f=!0;return{init:function(e){if(!e.iframeUrl)throw"You must specify iframeUrl";u?console.log("xdLocalStorage was already initialized!"):(u=!0,o()?t(e):document.addEventListener?document.addEventListener("readystatechange",function(){o()&&t(e)}):document.attachEvent("readystatechange",function(){o()&&t(e)}))},setItem:function(e,n,t){a()&&i("set",e,n,t)},getItem:function(e,n){a()&&i("get",e,null,n)},removeItem:function(e,n){a()&&i("remove",e,null,n)},key:function(e,n){a()&&i("key",e,null,n)},getSize:function(e){a()&&i("size",null,null,e)},getLength:function(e){a()&&i("length",null,null,e)},clear:function(e){a()&&i("clear",null,null,e)},wasInit:function(){return u}}}();