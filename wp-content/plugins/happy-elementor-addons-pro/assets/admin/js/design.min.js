"use strict";!function(e,i){var t=i.modules.controls.Select.extend({isSurpriseControl:function(){return"_ha_design"===this.model.get("name")&&-1!==this.getWidgetName().indexOf("ha-")},onReady:function(){window.happyDesigns=window.happyDesigns||{},this.fetchSurprises()},onRender:function(){this.constructor.__super__.onRender.apply(this,arguments),this.isSurpriseControl()&&this.addResetButton()},addResetButton:function(){var t=this;this.ui.select.before('<i title="Reset Style" class="eicon-redo ha-reset-design ha-reset-design--disable" aria-hidden="true"></i>'),this.$el.find(".ha-reset-design").on("click",function(){var e=i.getPanelView().getCurrentPageView().getOption("editedElementView");e&&e.resetStyle(),t.ui.select.val(""),t.setSettingsModel("")})},getWidgetName:function(){return this.elementSettingsModel.get("widgetType")},isFetched:function(){return!_.isUndefined(window.happyDesigns[this.getWidgetName()])},fetchSurprises:function(){var t=this;this.isSurpriseControl()&&!this.isFetched()&&this.getWidgetName()&&e.get(hapro.ajaxUrl,{action:"ha_make_me_surprised",widget:this.getWidgetName(),secret:hapro.secret}).done(function(e){e.success&&t.setSurprises(e.data)})},setSurprises:function(e){window.happyDesigns[this.getWidgetName()]=JSON.parse(e)},getSurprises:function(){return!_.isUndefined(window.happyDesigns)&&window.happyDesigns[this.getWidgetName()]||{}},onBaseInputChange:function(e){var t;this.constructor.__super__.onBaseInputChange.apply(this,arguments),this.isSurpriseControl()&&e.currentTarget.value&&(e.stopPropagation(),t=this.getSurprises(),_.isUndefined(t[e.currentTarget.value])||this.applySurprise(t[e.currentTarget.value]))},applySurprise:function(r){var e=this.elementSettingsModel.controls,o=this,t={};_.each(e,function(e,n){var s;o.model.get("name")!==n&&(_.isUndefined(r[n])||(e.is_repeater&&((s=o.elementSettingsModel.get(n).clone()).each(function(e,i){_.isUndefined(r[n][i])||_.each(e.controls,function(e,t){o.isStyleTransferControl(e)&&s.at(i).set(t,r[n][i][t])})}),t[n]=s),o.isStyleTransferControl(e)&&(t[n]=r[n])))}),this.elementSettingsModel.set(t)},isStyleTransferControl:function(e){return!_.isUndefined(e.style_transfer)&&e.style_transfer?e.style_transfer:"content"!==e.tab||e.selectors||e.prefix_class}});i.addControlView("select",t)}(window.jQuery,window.elementor);